<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebSocket 테스트</title>
</head>
<body>
    <h1>WebSocket 테스트 클라이언트</h1>
    <button onclick="createRoom()">방 만들기</button>
    <button onclick="joinRoom()">방 참가</button>
    <button onclick="ready()">준비 완료</button>
    <pre id="log"></pre>

    <script>
        const ws = new WebSocket('ws://mkmc.duckdns.org:8082'); // WebSocket 서버 주소
        const log = document.getElementById('log');
        let roomId = null;

        ws.onopen = () => {
            logMessage('✅ WebSocket 연결 성공');
        };

        ws.onmessage = (event) => {
            const data = JSON.parse(event.data);
            logMessage(`📩 서버 응답: ${event.data}`);

            if (data.type === 'roomCreated') {
                roomId = data.roomId;
                logMessage(`🏠 방 생성 완료! ID: ${roomId}`);
            } else if (data.type === 'roomJoined') {
                roomId = data.roomId;
                logMessage(`👥 방 참가 완료! ID: ${roomId}`);
            } else if (data.type === 'gameStart') {
                logMessage('🚀 게임이 시작되었습니다!');
            }
        };

        ws.onclose = () => {
            logMessage('❌ WebSocket 연결 종료');
        };

        ws.onerror = (error) => {
            logMessage('⚠️ WebSocket 오류 발생');
            console.error(error);
        };

        function createRoom() {
            if (ws.readyState === WebSocket.OPEN) {
                ws.send(JSON.stringify({ type: 'createRoom' }));
            } else {
                logMessage('⚠️ WebSocket이 연결되지 않음');
            }
        }

        function joinRoom() {
            if (roomId) {
                ws.send(JSON.stringify({ type: 'joinRoom', roomId }));
            } else {
                logMessage('⚠️ 먼저 방을 생성하거나, 존재하는 방 ID를 입력하세요.');
            }
        }

        function ready() {
            if (roomId) {
                ws.send(JSON.stringify({ type: 'ready', roomId }));
            } else {
                logMessage('⚠️ 방에 참가해야 준비 완료를 보낼 수 있습니다.');
            }
        }

        function logMessage(message) {
            log.textContent += message + '\n';
        }
    </script>
</body>
</html>
